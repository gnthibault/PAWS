<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ escape(handler.settings["name"]) }}</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/panoptes.css"> 
    <link rel="stylesheet" href="/static/css/blueimp-gallery.min.css">    
    <link rel="shortcut icon" href="/static/img/favicon.ico">
  {% block head %}{% end %}
</head>
<body>
  {% include 'nav.hbs' %}
  <div class="container-fluid">
      {% block content %}{% end %}
  </div>
  {% include 'footer.hbs' %}
  <script src="/static/js/jquery.min.js"></script>
  <script src="/static/js/bootstrap.min.js"></script>
  <script src="/static/js/panoptes.js"></script>
  <script src="/static/js/blueimp-gallery.min.js"></script>
  <script type="text/javascript">
    // Startup
    var ws;
    $( document ).ready(function() {
      // Image refresh timer
      second = 1000;

      // Websocket
      ws = WebSocketTest(window.location.host);

      // Aladin embed
      //var aladin = A.aladin('#aladin-lite-div');
      //var aladin = A.aladin('#aladin-lite-div', {survey: "P/DSS2/color", fov:60});
//       aladin.displayFITS("http://localhost:8000/static/images/latest_pointing.fits");
//         File "/data/boch/cgi/fits2HiPS/fits2HiPS.py", line 214, in <module>
//         r = requests.get(url, verify=False)
//         File "/usr/local/lib/python2.7/dist-packages/requests/api.py", line 75, in get
//         return request('get', url, params=params, **kwargs)
//         File "/usr/local/lib/python2.7/dist-packages/requests/api.py", line 60, in request
//         return session.request(method=method, url=url, **kwargs)
//         File "/usr/local/lib/python2.7/dist-packages/requests/sessions.py", line 533, in request
//         resp = self.send(prep, **send_kwargs)
//         File "/usr/local/lib/python2.7/dist-packages/requests/sessions.py", line 646, in send
//         r = adapter.send(request, **kwargs)
//         File "/usr/local/lib/python2.7/dist-packages/requests/adapters.py", line 516, in send
//         raise ConnectionError(e, request=request)
//    ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=8000): Max retries exceeded with url: /static/images/latest_pointing.fits (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f5daff77350>: Failed to establish a new connection: [Errno 111] Connection refused',))

//    aladin.addCatalog(A.catalogHiPS("http://localhost:8000/static/images/HIPS/"))

      // Refresh images
      setInterval(refresh_images, 60 * second);

      $('#chat_clear').on('click', function(){
        event.preventDefault();
        $('#bot_chat').empty();
      });

      $('#park_button').on('click', function(){
        event.preventDefault();
        ws.send('park');

        $('#park_button').addClass('disabled');
        $('#polar_align_button').addClass('disabled');
        $('#unpark_button').addClass('disabled');
      });

      $('#unpark_button').on('click', function(){
        event.preventDefault();
        ws.send('unpark');

        $('#park_button').removeClass('disabled');
        $('#polar_align_button').removeClass('disabled');
        $('#unpark_button').addClass('disabled');
      });

      $('#polar_align_button').on('click', function(){
        event.preventDefault();
        ws.send('polar_alignment');

        $('#park_button').addClass('disabled');
        $('#unpark_button').addClass('disabled');
        $('#polar_align_button').addClass('disabled');
      });


      // Block for include js per page
      {% block bottom %}{% end %}
    });
  </script>
</body>
</html>